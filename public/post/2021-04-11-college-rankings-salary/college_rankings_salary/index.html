<!DOCTYPE html><html lang="en-us" >

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.1.0 for Hugo" />
  

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Mark LeBoeuf" />

  
  
  
    
  
  <meta name="description" content="College rankings are a standard input for most students when choosing a school. But to what extent does a college&#39;s rank relate to how much a graduate makes 10 years into their career? We&#39;ll answer this question by web scraping data from a variety of online sources with R and Python, and then build a model to understand which factors matter most to post-college pay." />

  
  <link rel="alternate" hreflang="en-us" href="http://example.org/post/2021-04-11-college-rankings-salary/college_rankings_salary/" />

  







  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    <meta name="theme-color" content="#1565c0" />
  

  
  

  
  
  
  
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">

    
    

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/tomorrow-night-eighties.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/tomorrow-night-eighties.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
      
    

    
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css" integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      
        
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.7e30e35693ce5241bf21fbf454066bdd.css" />

  



  

  

  




  
  
  

  

  
    <link rel="manifest" href="/index.webmanifest" />
  

  <link rel="icon" type="image/png" href="/media/icon_huc737709a4be44af6221d1cabfe197959_22580_32x32_fill_lanczos_center_2.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_huc737709a4be44af6221d1cabfe197959_22580_180x180_fill_lanczos_center_2.png" />

  <link rel="canonical" href="http://example.org/post/2021-04-11-college-rankings-salary/college_rankings_salary/" />

  
  
  
  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary" />
  
  <meta property="og:site_name" content="The Code Forest" />
  <meta property="og:url" content="http://example.org/post/2021-04-11-college-rankings-salary/college_rankings_salary/" />
  <meta property="og:title" content="College Rankings and Pay | The Code Forest" />
  <meta property="og:description" content="College rankings are a standard input for most students when choosing a school. But to what extent does a college&#39;s rank relate to how much a graduate makes 10 years into their career? We&#39;ll answer this question by web scraping data from a variety of online sources with R and Python, and then build a model to understand which factors matter most to post-college pay." /><meta property="og:image" content="http://example.org/media/icon_huc737709a4be44af6221d1cabfe197959_22580_512x512_fill_lanczos_center_2.png" />
    <meta property="twitter:image" content="http://example.org/media/icon_huc737709a4be44af6221d1cabfe197959_22580_512x512_fill_lanczos_center_2.png" /><meta property="og:locale" content="en-us" />
  
    
      <meta
        property="article:published_time"
        content="2021-04-11T21:13:14-05:00"
      />
    
    <meta property="article:modified_time" content="2021-04-11T21:13:14-05:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://example.org/post/2021-04-11-college-rankings-salary/college_rankings_salary/"
  },
  "headline": "College Rankings and Pay",
  
  "datePublished": "2021-04-11T21:13:14-05:00",
  "dateModified": "2021-04-11T21:13:14-05:00",
  
  "author": {
    "@type": "Person",
    "name": "Mark LeBoeuf"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "The Code Forest",
    "logo": {
      "@type": "ImageObject",
      "url": "http://example.org/media/icon_huc737709a4be44af6221d1cabfe197959_22580_192x192_fill_lanczos_center_2.png"
    }
  },
  "description": "College rankings are a standard input for most students when choosing a school. But to what extent does a college's rank relate to how much a graduate makes 10 years into their career? We'll answer this question by web scraping data from a variety of online sources with R and Python, and then build a model to understand which factors matter most to post-college pay."
}
</script>

  

  

  

  





  <title>College Rankings and Pay | The Code Forest</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="29b6f9266ef061247f83c6993885935a" >

  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.226a9011996d125bf3fe4a5f22353a49.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    












<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container-xl">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">The Code Forest</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">The Code Forest</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>About</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

      
      
        
          
          <li class="nav-item d-none d-lg-inline-flex">
            <a class="nav-link" href="/"  aria-label="">
              <i class="fas fa-" aria-hidden="true"></i>
            </a>
          </li>
        
      

      
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
          <i class="fas fa-moon" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      
      

    </ul>

  </div>
</nav>


  </div>

  <div class="page-body">
    <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>College Rankings and Pay</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Apr 11, 2021
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    25 min read
  </span>
  

  
  
  
  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/category/college-rankings/">College Rankings</a>, <a href="/category/career/">Career</a>, <a href="/category/r/">R</a>, <a href="/category/python/">Python</a></span>
  

</div>

    





  
</div>



  <div class="article-container">

    <div class="article-style">
      


<p><img src="/post/2021-04-11-college-rankings-salary/images/belushi.jpg" width="700" height="400" /></p>
<div id="overview" class="section level3">
<h3>Overview</h3>
<p>Rankings are a pervasive part of modern life, especially for big decisions – like shelling out thousands of dollars for an education. Indeed, college rankings are among the most widely cited rankings in existence. So naturally, students, parents, and college administrators fret about where their school lands along these highly debated spectrums. But does it matter in terms of future earnings potential? While education is more than a simple “means to an end,” making a decent living is amongst the reasons why students pull all-nighters, work terrible summer jobs, and do everything they can to position themselves for a lucrative, meaningful career. Accordingly, this post will focus on the following topics:</p>
<p>🤓 Understanding the relationship between mid-career pay and college ranking after accounting for external variables (e.g., % of STEM degrees conferred each year).</p>
<p>🤓 Understanding the relative contribution of all variables to mid-career pay.</p>
<p>Since I’m a big fan of Learning-by-doing, I’ve included all code used to answer these questions. If you are simply interested in the answers <a href="#analysis">click here</a>.</p>
</div>
<div id="data-collection" class="section level3">
<h3>Data Collection</h3>
<p>Let’s start off by defining our data sources, which include:</p>
<ul>
<li><p>Mid-career pay by college from <a href="www.payscale.com">payscale.com</a>.</p></li>
<li><p>Undergraduate college rankings from <a href="https://www.forbes.com/top-colleges/#551bb5519877">forbes</a></p></li>
<li><p>Cost of living index by state from <a href="https://meric.mo.gov/data/cost-living-data-series">here</a></p></li>
</ul>
<p>The data is stored across various websites, so we’ll need to first scrape and format it prior to doing any analysis. All source code for the data-collections functions is in the <a href="#appendix">appendix</a>. Each can be executed by using the <code>reticulate</code> package. However, if you want to follow along with analysis and avoid all of the web-scraping (my recommendation), you can pull the data directly into R from Github.</p>
<pre class="r"><code># Core package
library(tidyverse)
library(janitor)

# Calling python functions from R
library(reticulate)

# For joins
library(fuzzyjoin)

# Modeling packages
library(broom)
library(recipes)
library(rsample)
library(tidymodels)
library(tidytext)

# Explainable ML
library(DALEX)
library(DALEXtra)

# --- Uncomment to scrape the original data
# specify which version of Python to use
# reticulate::use_python(&#39;//anaconda/bin/python&#39;, required = TRUE)
# reticulate::source_python(&#39;college_cost_of_living_data.py&#39;)
# reticulate::source_python(&#39;collect_payscale_data.py&#39;)
# reticulate::source_python(&#39;collect_college_ranks.py&#39;)
# col_df &lt;- collect_col_data()
# pay_df &lt;- collect_payscale_data()
# ranks_df &lt;- collect_college_ranks_data()

# --- Download from Github
url &lt;- &quot;https://raw.githubusercontent.com/thecodeforest/codeforest_datasets/main&quot;
post_location &lt;- &quot;college_rankings_salary_data&quot;
full_path &lt;- file.path(url, post_location)
col_df &lt;- read_csv(file.path(full_path, &#39;cost_of_living.csv&#39;)) %&gt;% clean_names()
pay_df &lt;- read_csv(file.path(full_path, &#39;college_pay.csv&#39;)) %&gt;% clean_names()
ranks_df &lt;- read_csv(file.path(full_path, &#39;college_ranks.csv&#39;)) %&gt;% clean_names()</code></pre>
<p>We’ll start by doing some cleaning and exploratory data analysis (EDA) after loading our data.</p>
<pre class="r"><code>pay_df_clean &lt;- pay_df %&gt;% 
  clean_names() %&gt;% 
  rename(college_name = name,
         pay_rank = rank
  ) %&gt;% 
  select(college_name, type, state, pay_rank, early_pay, mid_pay, pct_stem) %&gt;% 
  mutate(college_name = str_to_lower(college_name),
         college_name = str_replace_all(college_name, &quot;_&quot;, &quot; &quot;),
         pct_stem = parse_number(pct_stem),
         early_pay = parse_number(early_pay),
         mid_pay = parse_number(mid_pay)
  )</code></pre>
<p>Let’s peak at the first few rows of the compensation data.</p>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#pzzwqgdksd .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 10px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pzzwqgdksd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pzzwqgdksd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pzzwqgdksd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pzzwqgdksd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pzzwqgdksd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pzzwqgdksd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pzzwqgdksd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pzzwqgdksd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pzzwqgdksd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pzzwqgdksd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pzzwqgdksd .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#pzzwqgdksd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pzzwqgdksd .gt_from_md > :first-child {
  margin-top: 0;
}

#pzzwqgdksd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pzzwqgdksd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pzzwqgdksd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#pzzwqgdksd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pzzwqgdksd .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#pzzwqgdksd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pzzwqgdksd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pzzwqgdksd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pzzwqgdksd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pzzwqgdksd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pzzwqgdksd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#pzzwqgdksd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pzzwqgdksd .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#pzzwqgdksd .gt_left {
  text-align: left;
}

#pzzwqgdksd .gt_center {
  text-align: center;
}

#pzzwqgdksd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pzzwqgdksd .gt_font_normal {
  font-weight: normal;
}

#pzzwqgdksd .gt_font_bold {
  font-weight: bold;
}

#pzzwqgdksd .gt_font_italic {
  font-style: italic;
}

#pzzwqgdksd .gt_super {
  font-size: 65%;
}

#pzzwqgdksd .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="pzzwqgdksd" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table" style="table-layout: fixed;; width: 0px">
  <colgroup>
    <col style="width:100px;"/>
    <col style="width:100px;"/>
    <col style="width:100px;"/>
    <col style="width:100px;"/>
    <col style="width:100px;"/>
    <col style="width:100px;"/>
    <col style="width:100px;"/>
  </colgroup>
  <thead class="gt_header">
    <tr>
      <th colspan="7" class="gt_heading gt_title gt_font_normal" style><strong>Sample Compensentation Data</strong></th>
    </tr>
    <tr>
      <th colspan="7" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">college_name</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">type</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">state</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">pay_rank</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">early_pay</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">mid_pay</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">pct_stem</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_center">harvey mudd college</td>
      <td class="gt_row gt_center">Engineering, Liberal Arts School, Private School</td>
      <td class="gt_row gt_center">California</td>
      <td class="gt_row gt_center">1</td>
      <td class="gt_row gt_center">91400</td>
      <td class="gt_row gt_center">162500</td>
      <td class="gt_row gt_center">85</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">massachusetts institute of technology (mit)</td>
      <td class="gt_row gt_center">Engineering, Private School, Research University</td>
      <td class="gt_row gt_center">Massachusetts</td>
      <td class="gt_row gt_center">2</td>
      <td class="gt_row gt_center">88300</td>
      <td class="gt_row gt_center">158100</td>
      <td class="gt_row gt_center">69</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">united states naval academy (usna) at annapolis</td>
      <td class="gt_row gt_center">Engineering, Liberal Arts School, Sober School, For Sports Fans, State School</td>
      <td class="gt_row gt_center">Maryland</td>
      <td class="gt_row gt_center">3</td>
      <td class="gt_row gt_center">79600</td>
      <td class="gt_row gt_center">152600</td>
      <td class="gt_row gt_center">58</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">princeton university</td>
      <td class="gt_row gt_center">Ivy League, Private School, Research University, For Sports Fans</td>
      <td class="gt_row gt_center">New Jersey</td>
      <td class="gt_row gt_center">4</td>
      <td class="gt_row gt_center">77300</td>
      <td class="gt_row gt_center">150500</td>
      <td class="gt_row gt_center">48</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">california institute of technology (caltech)</td>
      <td class="gt_row gt_center">Engineering, Private School, Research University</td>
      <td class="gt_row gt_center">California</td>
      <td class="gt_row gt_center">5</td>
      <td class="gt_row gt_center">87600</td>
      <td class="gt_row gt_center">150300</td>
      <td class="gt_row gt_center">97</td>
    </tr>
  </tbody>
  
  
</table></div>
<p>We’ll merge the cost of living (COL) and college rankings data in the next two steps. Let’s start with COL by state to adjust for its effect on pay. The rationale for adding this variable is that many college graduates end up working in the same city or state as their college. For example, if you go to Ohio State, there’s a good chance you’ll take a job in Ohio. Likewise, if you attend New York University, you’ll probably end up somewhere in New York. Therefore, the cost of living in Ohio is different from New York, and employers take this into account when setting salaries. However, these cost differences are not related to the rank of one’s college, so to get a better idea of the relationship between college rank and mid-career pay, we’ll want to “adjust” for these variables.</p>
<pre class="r"><code>pay_df_clean &lt;- inner_join(pay_df_clean, col_df, on=&#39;state&#39;)</code></pre>
<p>The next step is a bit trickier. We’ll be joining on (gasp!) the college’s name to bring together compensation and college rankings. Anyone who has spent a few minutes working with data knows it’s generally a bad idea to join on strings, especially when those strings come from unrelated data sources. Indeed, I came across this tweet the other day, and I feel seen.</p>
<p><img src="/post/2021-04-11-college-rankings-salary/images/philadelphia.png" width="400" height="200" /><br />
However, as data scientists, we rarely have the dataset we want, so we’ll have to employ the magic you see below to create a consistent mapping between college names (Yes, regular expressions have always felt magical to me).</p>
<pre class="r"><code>pay_df_clean &lt;- pay_df_clean %&gt;% 
  mutate(college_name = str_replace_all(college_name, &quot; \\(.+?\\)&quot;, &quot;&quot;),
        college_name = str_replace_all(college_name, &#39;%2c&#39;, &#39;,&#39;),
        college_name = str_replace_all(college_name, &#39;%26&#39;, &#39;&amp;&#39;),
        college_name = str_replace_all(college_name, &#39;%27&#39;, &quot;&#39;&quot;),
        college_name = str_replace_all(college_name, &#39;at (.+/?)&#39;, &#39;&#39;), 
        college_name = str_replace_all(college_name, &#39;,\\s[a-z][a-z]&#39;, &#39;&#39;), # state at end
        college_name = str_replace_all(college_name, &#39; - &#39;, &#39;-&#39;),
        college_name = str_trim(college_name)
        )</code></pre>
<p>We’ll also do some light cleaning for the college ranks data.</p>
<pre class="r"><code>ranks_df_clean &lt;- ranks_df %&gt;% 
  rename(college_name = friendly_name,
         college_rank = rank
         ) %&gt;% 
  mutate(college_name = tolower(college_name)) %&gt;% 
  na.omit()</code></pre>
<p>In the next step, we’ll bring the compensation and college rankings together via a “fuzzy join.” This type of join is useful when the key (or field(s) you join is “close enough” but not an exact match. The <code>max_dist</code> parameter below is how we define “close enough.” The lower the number for this parameter, the closer two strings will need to be in their structure to match.</p>
<pre class="r"><code>analysis_df &lt;- stringdist_inner_join(pay_df_clean, 
                                     ranks_df_clean,
                                     by=&#39;college_name&#39;,
                                     max_dist=2
                                     )
n_row_reduced &lt;- round((nrow(pay_df_clean) - nrow(analysis_df)) / nrow(pay_df_clean) * 100, 2)
print(glue::glue(&#39;Pct excluded: {n_row_reduced}%&#39;))</code></pre>
<pre><code>## Pct excluded: 29.82%</code></pre>
<p>A good practice after executing an inner-join is to determine if the number of records has changed. The number of records are reduced by 29.82% following our join. If I were compensated for this analysis, I would return to the regular expressions above to see where I could further improve the match rate. However, we’ll trudge along with our smaller dataset to keep things moving along.</p>
<p>The other thing to keep in mind with fuzzy joins is that duplicate matches can occur, which the example below illustrates:</p>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#ouepnnabqq .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 10px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ouepnnabqq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ouepnnabqq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ouepnnabqq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ouepnnabqq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ouepnnabqq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ouepnnabqq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ouepnnabqq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ouepnnabqq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ouepnnabqq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ouepnnabqq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ouepnnabqq .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#ouepnnabqq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ouepnnabqq .gt_from_md > :first-child {
  margin-top: 0;
}

#ouepnnabqq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ouepnnabqq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ouepnnabqq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#ouepnnabqq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ouepnnabqq .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#ouepnnabqq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ouepnnabqq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ouepnnabqq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ouepnnabqq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ouepnnabqq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ouepnnabqq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#ouepnnabqq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ouepnnabqq .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#ouepnnabqq .gt_left {
  text-align: left;
}

#ouepnnabqq .gt_center {
  text-align: center;
}

#ouepnnabqq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ouepnnabqq .gt_font_normal {
  font-weight: normal;
}

#ouepnnabqq .gt_font_bold {
  font-weight: bold;
}

#ouepnnabqq .gt_font_italic {
  font-style: italic;
}

#ouepnnabqq .gt_super {
  font-size: 65%;
}

#ouepnnabqq .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="ouepnnabqq" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table" style="table-layout: fixed;; width: 0px">
  <colgroup>
    <col style="width:100px;"/>
    <col style="width:100px;"/>
    <col style="width:100px;"/>
  </colgroup>
  <thead class="gt_header">
    <tr>
      <th colspan="3" class="gt_heading gt_title gt_font_normal" style><strong>Names with Multiple Matches</strong></th>
    </tr>
    <tr>
      <th colspan="3" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">college_name.x</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">college_name.y</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">n_match</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_center">stanford university</td>
      <td class="gt_row gt_center">stanford university</td>
      <td class="gt_row gt_center">1</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">stanford university</td>
      <td class="gt_row gt_center">samford university</td>
      <td class="gt_row gt_center">2</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">brown university</td>
      <td class="gt_row gt_center">brown university</td>
      <td class="gt_row gt_center">1</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">brown university</td>
      <td class="gt_row gt_center">rowan university</td>
      <td class="gt_row gt_center">2</td>
    </tr>
  </tbody>
  
  
</table></div>
<p>The duplicate issue can be addressed by taking the closest match. Fortunately, our observations are ordered in terms of similarity, so we can take the first match and exclude matches with a rank other than 1.</p>
<pre class="r"><code>analysis_df &lt;- analysis_df %&gt;% 
  filter(n_match == 1) %&gt;% 
  select(-n_match, college_name.y) %&gt;% 
  rename(college_name = college_name.x) %&gt;% 
  na.omit() </code></pre>
<p>We are now ready to move on to some basic analysis.</p>
</div>
<div id="analysis" class="section level3">
<h3>Analysis</h3>
<p>Let’s start by examining the relationship between our two main variables of interest: college rank and mid-career pay.</p>
<p><img src="/post/2021-04-11-college-rankings-salary/college_rankings_salary_files/figure-html/unnamed-chunk-11-1.png" width="960" /></p>
<p>Earnings drop quicker for highly ranked colleges relative to lower ranked colleges. Let’s break this out by bucketing the ranks and examining the slopes for each bucket – that is, the expected change in salary as the ranking decreases by one.</p>
<pre class="r"><code>analysis_df = analysis_df %&gt;% 
  mutate(rank_bucket = case_when(college_rank &gt;= 1 &amp; college_rank &lt;= 50 ~ &#39;1 - 50&#39;,
                                 college_rank &gt;= 51 &amp; college_rank &lt;= 100 ~ &#39;51 - 100&#39;,
                                 college_rank &gt; 100 &amp; college_rank &lt;= 200 ~ &#39;101 - 200&#39;,
                                 college_rank &gt; 200 &amp; college_rank &lt;= 300 ~ &#39;201 - 300&#39;,
                                 college_rank &gt; 300 &amp; college_rank &lt;= 400 ~ &#39;301 - 400&#39;,
                                 college_rank &gt; 400 ~ &#39;&gt; 400&#39;
  )
  )</code></pre>
<p>Let’s visualize the slopes for each bucket.</p>
<pre class="r"><code>rank_bucket_est = analysis_df %&gt;% 
  group_by(rank_bucket) %&gt;% 
  do(tidy(lm(mid_pay ~ college_rank, data=.))) %&gt;% 
  select(rank_bucket, term, estimate) %&gt;% 
  ungroup() %&gt;% 
  reshape::cast(rank_bucket ~ term, value = &#39;estimate&#39;) %&gt;% 
  clean_names() %&gt;% 
  rename(rank_coeff = college_rank)

rank_bucket_est &lt;- rank_bucket_est %&gt;% 
  inner_join(analysis_df, by = &#39;rank_bucket&#39;) %&gt;% 
  mutate(predicted_income = college_rank * rank_coeff + intercept) %&gt;% 
  mutate(rank_bucket = factor(rank_bucket,
                              levels = c(&#39;1 - 50&#39;,
                                         &#39;51 - 100&#39;,
                                         &#39;101 - 200&#39;,
                                         &#39;201 - 300&#39;,
                                         &#39;301 - 400&#39;,
                                         &#39;&gt; 400&#39;
                              )
  ))</code></pre>
<p><img src="/post/2021-04-11-college-rankings-salary/college_rankings_salary_files/figure-html/unnamed-chunk-14-1.png" width="960" /></p>
<p>While the relationship between earnings and rank is non-linear, this provides a rough estimate of what we initially noticed in the first scatterplot. For example, colleges in the 1- 50 bucket experienced a pay decrease of ~$520 for each one-unit reduction in rank. In contrast, for colleges in the &gt; 400 bucket, a one-unit reduction in position results only in a ~$34 drop in compensation.</p>
<p>At this point, we’ve established that (1) rank is a decent predictor of earnings, and (2) the nature of this relationship varies by the level of the rank, indicating that a modeling approach that handles non-linearity would likely perform better than our current linear model. Accordingly, we’ll use a tree-based algorithm to capture these non-linearities and any interactions between college rank and our other variables.</p>
</div>
<div id="feature-engineering-modeling" class="section level3">
<h3>Feature Engineering &amp; Modeling</h3>
<p>We’ll start by defining how we’ll evaluate our model’s performance. For regression problems, I like to begin with mean-absolute-error (MAE) as an evaluation metric for one reason: it expresses how large of an error I can expect in the original units of my outcome variable. Framing our model’s performance in this way makes it easier to interpret and explain when it comes down to evaluating how much faith I should put in the outputs.</p>
<pre class="r"><code># define key metric that we want to evaluate against
mset &lt;- metric_set(mae)

# specify x variables
x_vars = c(&#39;pct_stem&#39;, &#39;type&#39; ,&#39;cost_of_living&#39;, &#39;college_rank&#39;)
y_var = &#39;mid_pay&#39;
id_vars = &#39;college_name&#39;
model_df &lt;- analysis_df %&gt;% select(c(id_vars, x_vars, y_var))</code></pre>
<p>We’ll also do some minimal feature engineering on the <code>type</code> field, which classifies colleges as being one of the following types:</p>
<pre class="r"><code>college_types &lt;- model_df %&gt;% 
  separate_rows(type, sep = &quot;, &quot;) %&gt;% 
  count(type, sort = TRUE) </code></pre>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#gsyjfxoqvi .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 10px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gsyjfxoqvi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gsyjfxoqvi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gsyjfxoqvi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gsyjfxoqvi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gsyjfxoqvi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gsyjfxoqvi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gsyjfxoqvi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gsyjfxoqvi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gsyjfxoqvi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gsyjfxoqvi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gsyjfxoqvi .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#gsyjfxoqvi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gsyjfxoqvi .gt_from_md > :first-child {
  margin-top: 0;
}

#gsyjfxoqvi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gsyjfxoqvi .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gsyjfxoqvi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#gsyjfxoqvi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gsyjfxoqvi .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#gsyjfxoqvi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gsyjfxoqvi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gsyjfxoqvi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gsyjfxoqvi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gsyjfxoqvi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gsyjfxoqvi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#gsyjfxoqvi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gsyjfxoqvi .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#gsyjfxoqvi .gt_left {
  text-align: left;
}

#gsyjfxoqvi .gt_center {
  text-align: center;
}

#gsyjfxoqvi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gsyjfxoqvi .gt_font_normal {
  font-weight: normal;
}

#gsyjfxoqvi .gt_font_bold {
  font-weight: bold;
}

#gsyjfxoqvi .gt_font_italic {
  font-style: italic;
}

#gsyjfxoqvi .gt_super {
  font-size: 65%;
}

#gsyjfxoqvi .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="gsyjfxoqvi" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table" style="table-layout: fixed;; width: 0px">
  <colgroup>
    <col style="width:100px;"/>
    <col style="width:100px;"/>
  </colgroup>
  <thead class="gt_header">
    <tr>
      <th colspan="2" class="gt_heading gt_title gt_font_normal" style><strong>College Types</strong></th>
    </tr>
    <tr>
      <th colspan="2" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">type</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">n</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_center">Private School</td>
      <td class="gt_row gt_center">203</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">For Sports Fans</td>
      <td class="gt_row gt_center">145</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">Research University</td>
      <td class="gt_row gt_center">136</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">State School</td>
      <td class="gt_row gt_center">100</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">Liberal Arts School</td>
      <td class="gt_row gt_center">87</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">Religious</td>
      <td class="gt_row gt_center">75</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">Engineering</td>
      <td class="gt_row gt_center">26</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">Party School</td>
      <td class="gt_row gt_center">14</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">Ivy League</td>
      <td class="gt_row gt_center">8</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">Sober School</td>
      <td class="gt_row gt_center">8</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">Business</td>
      <td class="gt_row gt_center">6</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">Art</td>
      <td class="gt_row gt_center">2</td>
    </tr>
  </tbody>
  
  
</table></div>
<p>Some types of colleges may lead graduates into higher or lower-paying fields. First, however, we’ll have to translate these into a format that can feed into a machine learning model.</p>
<pre class="r"><code>college_type_feature &lt;- model_df %&gt;% 
  select(college_name, type) %&gt;%
  separate_rows(type, sep = &quot;, &quot;) %&gt;%
  recipe(.) %&gt;%
  update_role(college_name, new_role = &#39;id variable&#39;) %&gt;%
  step_dummy(type, one_hot=TRUE) %&gt;%
  step_nzv(all_predictors()) %&gt;%
  prep() %&gt;%
  juice() %&gt;%
  group_by(college_name) %&gt;%
  summarise_at(vars(starts_with(&#39;type_&#39;)), sum) %&gt;%
  clean_names()

names(college_type_feature) &lt;- str_replace(names(college_type_feature), &#39;type_&#39;, &#39;&#39;)
college_type_vars = setdiff(names(college_type_feature), &#39;college_name&#39;)</code></pre>
<p>Next, we’ll join the features back into our dataset and transition to building our model.</p>
<pre class="r"><code>model_df &lt;- model_df %&gt;%
  inner_join(college_type_feature, on = &#39;college_name&#39;) %&gt;%
  select(-type, -liberal_arts_school) %&gt;%
  relocate(y_var, .after = last_col())</code></pre>
<pre><code>## Joining, by = &quot;college_name&quot;</code></pre>
<p>We’ll start by splitting our data into training and testing. The train is used for tuning (or which combination of hyperparameters yields the lowest MAE). We’ll then test our final model on the holdout set to get a feel for overall performance.</p>
<pre class="r"><code>set.seed(2021)
spl &lt;- initial_split(model_df)
train &lt;- training(spl)
test &lt;- testing(spl)
train_folds &lt;- vfold_cv(train, v = 5, strata = y_var)</code></pre>
<p>Let’s specify our “recipe” below, which is the series of data-preparation steps executed before fitting our model.</p>
<pre class="r"><code>rank_recipe &lt;- 
  model_df %&gt;% 
  recipe(mid_pay ~ ., data = train) %&gt;% 
  update_role(college_name, new_role = &#39;id variable&#39;)</code></pre>
<p>Then, we’ll create a tuning grid for our XGBoost model.</p>
<pre class="r"><code>grid_control &lt;- control_grid(save_pred= TRUE,
                             save_workflow = TRUE,
                             extract = extract_model
                             )
xg_spec &lt;- boost_tree(mode=&#39;regression&#39;,
                      mtry = tune(),
                      trees = tune(),
                      learn_rate = .01
                      ) %&gt;% 
           set_engine(&quot;xgboost&quot;)</code></pre>
<p>Once tuning is complete and the algorithm has been specified, we’ll combine our steps into a <code>workflow</code>, which holds the fitting and predicting operations in a single object.</p>
<pre class="r"><code>xg_workflow &lt;- workflow() %&gt;% 
  add_recipe(rank_recipe) %&gt;% 
  add_model(xg_spec)</code></pre>
<p>Finally, we’ll pull in our split training data and evaluate performance across the different combinations of our hyperparameters. Note that we are not tuning the learning rate in an effort to minimize the number of combinations to test.</p>
<pre class="r"><code>set.seed(123)
xg_tuned &lt;- xg_workflow %&gt;% 
  tune_grid(train_folds,
            metrics = mset,
            grid = crossing(mtry = c(2, 4, 6, 8),
                            trees = seq(50, 1000, 50)
                            ),

            )</code></pre>
<p>The plot below indicates the performance across each of the combinations</p>
<p><img src="/post/2021-04-11-college-rankings-salary/college_rankings_salary_files/figure-html/unnamed-chunk-25-1.png" width="960" /></p>
<pre class="r"><code>xg_tuned %&gt;% 
collect_metrics() %&gt;% 
arrange(mean) %&gt;% 
head(5)</code></pre>
<pre><code>## # A tibble: 5 x 8
##    mtry trees .metric .estimator  mean     n std_err .config
##   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
## 1     6   500 mae     standard   6328.     5    236. Model50
## 2     6   550 mae     standard   6329.     5    259. Model51
## 3     6   600 mae     standard   6331.     5    287. Model52
## 4     6   650 mae     standard   6350.     5    325. Model53
## 5     6   700 mae     standard   6361.     5    352. Model54</code></pre>
<p>Based on these results, it looks like ~600 trees and six parameters yield the best results. Next, we’ll extract the best model, fit it to the complete training set, and see how well it performs on our test set.</p>
<pre class="r"><code>xg_fit &lt;- xg_workflow %&gt;% 
  finalize_workflow(select_best(xg_tuned)) %&gt;% 
  fit(train)

bind_cols(test, xg_fit %&gt;% predict(test)) %&gt;% 
  mae(mid_pay, .pred)</code></pre>
<pre><code>## # A tibble: 1 x 3
##   .metric .estimator .estimate
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 mae     standard       7411.</code></pre>
<p>While the MAE is higher here, it’s not too different from what we observed above, indicating that we aren’t overfitting with the hyperparameters we’ve selected. Now that we know how well the model performs on our holdout-set let’s examine which variables are the most important.</p>
<pre class="r"><code>var_imp &lt;- xgboost::xgb.importance(model = xg_fit$fit$fit$fit)

var_imp %&gt;% 
  clean_names() %&gt;% 
  mutate(feature = str_replace_all(feature, &#39;_&#39;, &#39; &#39;),
         feature = str_to_title(feature),
         feature = fct_reorder(feature, gain),) %&gt;% 
  ggplot(aes(feature, gain)) + 
  geom_col(color = &#39;black&#39;) + 
  coord_flip() + 
  theme_bw() + 
  my_plot_theme() + 
  labs(x=NULL,
       y=&#39;Feature Importance&#39;
       )</code></pre>
<p><img src="/post/2021-04-11-college-rankings-salary/college_rankings_salary_files/figure-html/unnamed-chunk-28-1.png" width="960" /></p>
<p>The variable importance ratings are unsurprising. College rank is the most important variable, followed by the percentage of students majoring in Science, Technology, Engineering, or Math (STEM) major, with Cost of Living possessing some additional explanatory power. The college-type variables appear somewhat less critical.</p>
</div>
<div id="interpreting-model-predictions" class="section level3">
<h3>Interpreting Model Predictions</h3>
<p>So far, we’ve established that college rank, cost of living, and college major (or the percentage of STEM students) are associated with variation in mid-career pay. However, to make this actionable, it helps to tailor these predictions to an individual’s circumstances. For example, let’s say we want a general idea of how much our mid-career salary varies between a subset of colleges. We can use a technique called “local model interpretation,” which can provide answers to the following questions:</p>
<ul>
<li>Why did our model predict $120,000?</li>
<li>What effect does college’s state or specific rank have on predicted mid-career earnings?</li>
</ul>
<p>The great thing about these techniques is that they open the “black box” of more intricate machine learning models rather than simply telling us which variables are more important than others. Below we’ll set up our “explainer” and test our previously trained model on specific observations.</p>
<pre class="r"><code>x_values = train[setdiff(names(train), y_var)]
y_values = train[y_var]

pred &lt;- function(model, newdata){
  results &lt;- model %&gt;% predict(newdata) %&gt;% pull(.pred)
  return(results)

}

explainer_xg &lt;- DALEX::explain(model=xg_fit,
                              data = x_values,
                              y = y_values,
                              predict_function = pred,
                              label = &#39;xg explainer&#39;,
                              verbose = FALSE
                        )</code></pre>
<p>Let’s test it out on my graduate college - Northwestern University (go Cats!). If you were an undergraduate attending Northwestern and plan to work within the state of Illinois, how much can you expect to make, and what factors are associated with an increase/decrease in potential mid-career earnings?</p>
<pre class="r"><code>nu_student &lt;- model_df %&gt;% filter(college_name == &#39;northwestern university&#39;)
nu_student_pred &lt;- DALEX::predict_parts_break_down(explainer_xg, nu_student)
plot(nu_student_pred)</code></pre>
<p><img src="/post/2021-04-11-college-rankings-salary/college_rankings_salary_files/figure-html/unnamed-chunk-30-1.png" width="960" /></p>
<p>The way to read this plot is to start at the top left and work your way down to the “prediction” row. The intercept represents the overall average. That is, if I knew nothing about a college, this is my best guess. Stepping down one row, we see that Northwestern is ranked 28th of all colleges, which contributes to ~$10K increase in mid career pay. However, the cost of living in Illinois appears to be lower than the rest of the country, which depresses expected earnings by ~$8K. From there, you can “walk” by each factor to get to the final prediction of $120K. This is how a breakdown plot works - it helps us understand which variables explain the most variation and how they contribute relative to one another.</p>
<p>We can even create a fictitious college, such as the the one below.</p>
<pre class="r"><code>state_u_student &lt;- tibble(college_name = &#39;State U&#39;,
                      college_rank = 400,
                      cost_of_living = mean(x_values %&gt;% pull(cost_of_living)),
                      pct_stem = 25,
                      for_sports_fans = 1,
                      private_school = 0,
                      religious = 0,
                      research_university = 1,
                      state_school = 1
)
state_u_student_pred &lt;- DALEX::predict_parts_break_down(explainer_xg, state_u_student)
plot(state_u_student_pred)</code></pre>
<p><img src="/post/2021-04-11-college-rankings-salary/college_rankings_salary_files/figure-html/unnamed-chunk-31-1.png" width="960" /></p>
<p>The plot above is interpreted exactly the same - if we attended “State U,” our expected annual mid-career pay would be somewhere around $98K.</p>
</div>
<div id="conclusion-does-rank-matter" class="section level3">
<h3>Conclusion: Does Rank Matter?</h3>
<p>It’s important to note that our outcome variable – median mid-career pay – is a summary statistic. Thus, we do not know how much information each college contributed to our estimates, as the raw data (i.e., the individual responses associated with each college) are not available. However, these findings feel correct. Even after considering the caveat mentioned above, it is apparent that where you attend college is strongly associated (but not necessarily cause) with shifts in how much you earn later in life. This is especially true for top-ranked colleges. The difference between attending a college ranked in the top-10 relative to the top-100 has substantial pay implications, while this difference is less critical among lower-ranked colleges.</p>
<p>Hopefully, you enjoyed the post. I’d love to hear your feedback, so feel free to comment below!</p>
</div>
<div id="appendix" class="section level3">
<h3>Appendix</h3>
<pre class="python"><code># college_cost_of_living_data.py
import urllib
from bs4 import BeautifulSoup
import re
import pandas as pd
from datetime import datetime
from typing import List
import logging

start_time = datetime.now().strftime(&quot;%Y-%m-%d %H-%M-%S&quot;)
logging.basicConfig(
    filename=f&quot;college-rankings-pay-{start_time}.log&quot;,
    format=&quot;%(levelname)s - %(asctime)s - %(filename)s - %(message)s&quot;,
    level=logging.DEBUG,
)
logger = logging.getLogger(__name__)


def scrape_col_data() -&gt; List[str]:
    base_url = &quot;https://meric.mo.gov/data/cost-living-data-series&quot;
    page = urllib.request.urlopen(base_url).read()
    soup = BeautifulSoup(page)
    col_data = soup.findAll(&quot;tbody&quot;)[0].findAll(&quot;tr&quot;)
    col_data_lst = str(col_data).split(&quot;&lt;/tr&gt;&quot;)
    return col_data_lst


def format_col_data(col_data_lst: List[str]) -&gt; pd.DataFrame:
    field_names = [&quot;state&quot;, &quot;cost_of_living&quot;]
    regex_state = re.compile(&quot;&gt;[0-9]{1,2}&lt;/td&gt;\n&lt;td&gt;(.+?)\xa0&lt;&quot;)
    regex_col_index = re.compile(&quot;\xa0&lt;/td&gt;\n&lt;td&gt;([0-9]{2,3}.\d)&lt;/td&gt;&quot;)
    all_states_col = list()
    for state in col_data_lst:
        try:
            state_name = re.search(regex_state, state).group(1)
            state_col = re.search(regex_col_index, state).group(1)
            row = [state_name, state_col]
            all_states_col.append(row)
        except Exception as e:
            logger.error(
                f&quot;Problem extract table from wikipedia for {state}&quot;, exc_info=True
            )
    all_states_df = pd.DataFrame(all_states_col, columns=field_names)
    return all_states_df


def collect_col_data() -&gt; pd.DataFrame():
    col_data_lst = scrape_col_data()
    col_df = format_col_data(col_data_lst=col_data_lst)
    return col_df</code></pre>
<pre class="python"><code># collect_payscale_data.py
import urllib
from bs4 import BeautifulSoup
import re
import pandas as pd
from typing import List
import time
from tqdm import tqdm

N_PAGES = 20

def scrape_pay_data(page_number: int) -&gt; List:
    base_url = f&quot;https://www.payscale.com/college-salary-report/bachelors/page/{str(page_number)}&quot;
    page = urllib.request.urlopen(base_url).read()
    soup = BeautifulSoup(page)
    college_data = soup.findAll(&quot;tbody&quot;)[0].findAll(&quot;tr&quot;)
    college_data = [str(x) for x in college_data]
    return college_data


def format_pay_data(college_data: str) -&gt; pd.DataFrame:
    field_names = [&quot;name&quot;, &quot;rank&quot;, &quot;type&quot;, &quot;pct_stem&quot;, &quot;early_pay&quot;, &quot;mid_pay&quot;]
    regex_name = re.compile(&#39;&lt;a href=&quot;/research/US/School=(.+?)/Salary&#39;)
    regex_rank = re.compile(
        &#39;&quot;&gt;Rank&lt;!-- --&gt;:&lt;/span&gt;&lt;span class=&quot;data-table__value&quot;&gt;(.+?)&lt;/span&gt;&#39;
    )
    regex_type = re.compile(
        &#39;&gt;School Type&lt;!-- --&gt;:&lt;/span&gt;&lt;span class=&quot;data-table__value&quot;&gt;(.+?)&lt;/span&gt;&#39;
    )
    regex_early_pay = re.compile(
        &#39;&gt;Early Career Pay&lt;!-- --&gt;:&lt;/span&gt;&lt;span class=&quot;data-table__value&quot;&gt;(.+?)&lt;/span&gt;&#39;
    )
    regex_mid_pay = re.compile(
        &#39;&gt;Mid-Career Pay&lt;!-- --&gt;:&lt;/span&gt;&lt;span class=&quot;data-table__value&quot;&gt;(.+?)&lt;/span&gt;&#39;
    )
    regex_pct_stem = re.compile(
        &#39;&gt;% STEM Degrees&lt;!-- --&gt;:&lt;/span&gt;&lt;span class=&quot;data-table__value&quot;&gt;(.+?)&lt;/span&gt;&#39;
    )
    all_college_data = list()
    # TO DO - ADD LOGGING
    for college in college_data:
        try:
            name = re.search(regex_name, college).group(1)
            rank = re.search(regex_rank, college).group(1)
            type_ = re.search(regex_type, college).group(1)
            early_pay = re.search(regex_early_pay, college).group(1)
            mid_pay = re.search(regex_mid_pay, college).group(1)
            pct_stem = re.search(regex_pct_stem, college).group(1)
            row = [name, rank, type_, pct_stem, early_pay, mid_pay]
            all_college_data.append(row)
        except Exception as e:
            print(e)
    college_df = pd.DataFrame(all_college_data, columns=FIELD_NAMES)
    return college_df

 
def collect_payscale_college_salary_data() -&gt; pd.DataFrame:
    all_colleges_df = pd.DataFrame(columns=FIELD_NAMES)
    for page_number in tqdm(range(1, (N_PAGES + 1))):
        college_data = scrape_pay_data(page_number=page_number)
        college_data_df = format_pay_data(college_data=college_data)
        all_colleges_df = all_colleges_df.append(college_data_df)
        time.sleep(2)
    return all_colleges_df</code></pre>
<pre class="r"><code># Helper function for visualization
my_plot_theme = function(){
  font_family = &quot;Helvetica&quot;
  font_face = &quot;bold&quot;
  return(theme(
    axis.text.x = element_text(size = 16, face = font_face, family = font_family),
    axis.text.y = element_text(size = 16, face = font_face, family = font_family),
    axis.title.x = element_text(size = 16, face = font_face, family = font_family),
    axis.title.y = element_text(size = 16, face = font_face, family = font_family),
    strip.text.y = element_text(size = 22, face = font_face, family = font_family),
    plot.title = element_text(size = 22, face = font_face, family = font_family),
    
    legend.position = &quot;top&quot;,
    legend.title = element_text(size = 16,
                                face = font_face,
                                family = font_family),
    legend.text = element_text(size = 16,
                               face = font_face,
                               family = font_family),
    legend.key = element_rect(size = 5),
    legend.key.size = unit(1.5, &#39;lines&#39;)
  ))
}</code></pre>
</div>

    </div>

    






<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/college-rankings/">College Rankings</a>
  
  <a class="badge badge-light" href="/tag/career/">Career</a>
  
  <a class="badge badge-light" href="/tag/r/">R</a>
  
  <a class="badge badge-light" href="/tag/python/">Python</a>
  
</div>













  
  



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="http://example.org/"><img class="avatar mr-3 avatar-circle" src="/author/mark-leboeuf/avatar_hu95484a0837f0832a1e8242074628a955_46074_270x270_fill_q75_lanczos_center.jpg" alt="Mark LeBoeuf"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="http://example.org/">Mark LeBoeuf</a></h5>
      <h6 class="card-subtitle">Data Scientist</h6>
      
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/" >
        <i class="fas fa-"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/thecodeforest" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/markleboeuf/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>




















  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">
<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "https-www-thecodeforest-io" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</footer>

    </div>
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      

      
      

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/python.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/latex.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/sql.min.js"></script>
        
      

    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js" integrity="sha512-SeiQaaDh73yrb56sTW/RgVdi/mMqNeM2oBwubFHagc5BkixSpP1fvqF47mKzPGWYSSy4RwbBunrJBQ4Co8fRWA==" crossorigin="anonymous"></script>
    

    
    

    
    
    
      
      <script id="search-hit-fuse-template" type="text/x-template">
        <div class="search-hit" id="summary-{{key}}">
          <div class="search-hit-content">
            <div class="search-hit-name">
              <a href="{{relpermalink}}">{{title}}</a>
              <div class="article-metadata search-hit-type">{{type}}</div>
              <p class="search-hit-description">{{snippet}}</p>
            </div>
          </div>
        </div>
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
      
    

    
    

    
    
    
    

    
    <script src="/js/bootstrap.bundle.min.6aed84840afc03ab4d5750157f69c120.js"></script>

    
    
      
      
      
      
      
      
      
    

    
    
    
    
    
    
    
    
      
      
    
    
    <script src="/en/js/wowchemy.min.b61a8f62b6e5c0cd322c8158c5b5dfb6.js"></script>

    
  <script async defer src="https://buttons.github.io/buttons.js"></script>




</body>
</html>
